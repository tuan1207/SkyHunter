{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/Plane.ts"],"names":["_decorator","Component","instantiate","Node","input","Input","KeyCode","Vec3","Collider2D","Contact2DType","Animation","Prefab","macro","UITransform","GameCtrl","Audio","ccclass","property","Plane","moveLeft","moveRight","moveUp","moveDown","touchEnabled","moveEnable","spawnEnabled","moveSpeed","listItemB","listItemR","countCont","onLoad","instance","on","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","start","Canvas","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","collider","getComponent","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","dt","planeMove","schedule","spawnBullet","REPEAT_FOREVER","spawnRocket","event","wp","touch","getUILocation","posMouse","node","parent","convertToNodeSpaceAR","x","y","joyStick","active","setPosition","Stick","touchNode","keyCode","KEY_A","KEY_D","KEY_W","KEY_S","ARROW_LEFT","ARROW_RIGHT","ARROW_UP","ARROW_DOWN","posX","position","posY","posPlane","selfCollider","otherCollider","contact","other","self","name","scheduleOnce","push","destroy","console","log","length","startsWith","onAudioQueue","checkHealth","playAnim","countDown","planeAnim","play","setTimeout","stop","bulletPrefab0","listBullet","prefabInstance0","setWorldPosition","worldPosition","z","j","bulletPrefab","prefabInstance","bulletPrefab5","prefabInstance5","prefabInstance6","listHealth","overNode","savePoint"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, input, Input, EventKeyboard, KeyCode, Vec3, Collider2D, Contact2DType, IPhysics2DContact, EPhysics2DDrawFlags, PhysicsSystem2D, Animation, Prefab, macro, Canvas, EventTouch, UITransform } from 'cc';\r\nimport { GameCtrl } from './GameCtrl';\r\nimport { Audio } from './Audio';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Plane')\r\nexport class Plane extends Component {\r\n    static instance: Plane;\r\n\r\n    @property(Node)\r\n    public Plane: Node = null;\r\n    @property(Animation)\r\n    public planeAnim: Animation = null;\r\n    @property(Prefab)\r\n    public listBullet: Prefab [] = [];\r\n    @property(Node)\r\n    public listHealth: Node [] = [];\r\n    @property(Node)\r\n    public joyStick: Node = null;\r\n    @property(Node)\r\n    public Stick: Node = null;\r\n    @property(Node)\r\n    public Canvas: Node = null;\r\n\r\n    moveLeft: boolean = false;\r\n    moveRight: boolean = false;\r\n    moveUp: boolean = false;\r\n    moveDown: boolean = false;\r\n    public touchEnabled: boolean = true;\r\n    public moveEnable: boolean = true;\r\n    public spawnEnabled: boolean = true;\r\n\r\n    public moveSpeed: number = 200;\r\n\r\n    public listItemB = [];\r\n    public listItemR = [];\r\n    public countCont = [];\r\n\r\n    protected onLoad(): void {\r\n        Plane.instance = this;\r\n        // PhysicsSystem2D.instance.enable = true;\r\n        // PhysicsSystem2D.instance.debugDrawFlags  = EPhysics2DDrawFlags.Aabb |\r\n        // EPhysics2DDrawFlags.Pair |\r\n        // EPhysics2DDrawFlags.CenterOfMass |\r\n        // EPhysics2DDrawFlags.Joint |\r\n        // EPhysics2DDrawFlags.Shape;\r\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        input.on(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n    protected onDestroy(): void {\r\n        input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        input.off(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n    protected start(): void {\r\n        this.Canvas.on(Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.Canvas.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);   \r\n        this.Canvas.on(Node.EventType.TOUCH_END, this.onTouchEnd, this); \r\n\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n    protected update(dt: number): void {\r\n        if(this.moveEnable === false) return;\r\n        this.planeMove(dt);\r\n        this.schedule(this.spawnBullet, 0.4, macro.REPEAT_FOREVER, 0);\r\n        this.schedule(this.spawnRocket, 0.7, macro.REPEAT_FOREVER, 0);\r\n    }\r\n    onTouchStart(event: EventTouch){\r\n        if (!this.touchEnabled) return;\r\n\r\n        let wp = event.touch.getUILocation();\r\n        let posMouse = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(new Vec3(wp.x, wp.y));\r\n        this.joyStick.active = true;\r\n        this.joyStick.setPosition(posMouse);\r\n        \r\n    }\r\n    onTouchMove(event: EventTouch){\r\n        if (!this.touchEnabled) return;\r\n\r\n        let wp = event.touch.getUILocation();\r\n        let posMouse = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(new Vec3(wp.x, wp.y));\r\n        this.Stick.setPosition(posMouse);\r\n        \r\n    }\r\n    onTouchEnd(){\r\n        this.touchNode.active = false;\r\n    }\r\n    onKeyDown(event: EventKeyboard){\r\n        if(!this.moveEnable) return;\r\n        switch(event.keyCode){\r\n            case KeyCode.KEY_A: this.moveLeft = true; break;\r\n            case KeyCode.KEY_D: this.moveRight = true; break;\r\n            case KeyCode.KEY_W: this.moveUp = true; break;\r\n            case KeyCode.KEY_S: this.moveDown = true; break;\r\n\r\n            case KeyCode.ARROW_LEFT: this.moveLeft = true; break;\r\n            case KeyCode.ARROW_RIGHT: this.moveRight = true; break;\r\n            case KeyCode.ARROW_UP: this.moveUp = true; break;\r\n            case KeyCode.ARROW_DOWN: this.moveDown = true; break;\r\n\r\n        }\r\n    }\r\n    onKeyUp(event: EventKeyboard){\r\n        if(!this.moveEnable) return;\r\n        switch(event.keyCode){\r\n            case KeyCode.KEY_A: this.moveLeft = false; break;\r\n            case KeyCode.KEY_D: this.moveRight = false; break;\r\n            case KeyCode.KEY_W: this.moveUp = false; break;\r\n            case KeyCode.KEY_S: this.moveDown = false; break;\r\n\r\n            case KeyCode.ARROW_LEFT: this.moveLeft = false; break;\r\n            case KeyCode.ARROW_RIGHT: this.moveRight = false; break;\r\n            case KeyCode.ARROW_UP: this.moveUp = false; break;\r\n            case KeyCode.ARROW_DOWN: this.moveDown = false; break;\r\n\r\n        }\r\n    }  \r\n    planeMove(dt: number){\r\n        let posX = this.Plane.position.x;\r\n        let posY = this.Plane.position.y;\r\n\r\n        if(this.moveLeft){\r\n            if(posX > -575){\r\n                posX -= this.moveSpeed * dt;\r\n            }\r\n            let posPlane = new Vec3(posX, posY);\r\n            this.Plane.setPosition(posPlane);\r\n        }\r\n        if(this.moveRight){\r\n            if(posX < 575){\r\n                posX += this.moveSpeed * dt;\r\n            }\r\n            let posPlane = new Vec3(posX, posY);\r\n            this.Plane.setPosition(posPlane);\r\n        }\r\n        if(this.moveUp){\r\n            if(posY < 340){\r\n                posY += this.moveSpeed * dt;\r\n            }\r\n            let posPlane = new Vec3(posX, posY);\r\n            this.Plane.setPosition(posPlane); \r\n        }\r\n        if(this.moveDown){\r\n            if(posY > -340){\r\n                posY -= this.moveSpeed * dt;\r\n            }\r\n            let posPlane = new Vec3(posX, posY);\r\n            this.Plane.setPosition(posPlane); \r\n        }\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        let other = otherCollider.node;\r\n        let self = selfCollider.node;\r\n        if(other.name === 'ItemB'){\r\n            this.scheduleOnce(() => {this.listItemB.push(other)});\r\n            this.scheduleOnce(() => {other.destroy()});\r\n            console.log(this.listItemB.length);\r\n        }\r\n        if(other.name === 'ItemR'){\r\n            this.scheduleOnce(() => {this.listItemR.push(other)});\r\n            this.scheduleOnce(() => {other.destroy()});\r\n            console.log(this.listItemR.length);\r\n        }\r\n        if(other.name.startsWith('enemy')){\r\n            Audio.instance.onAudioQueue(7);\r\n            this.scheduleOnce(() => {this.listItemR = []});\r\n            this.scheduleOnce(() => {this.listItemB = []});\r\n            this.scheduleOnce(() => {other.destroy()});\r\n            this.scheduleOnce(() => {this.countCont.push(other)});\r\n            this.scheduleOnce(() => this.checkHealth());\r\n        }\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n    }\r\n    playAnim(countDown: number){\r\n        this.planeAnim.play();\r\n        setTimeout(() => {\r\n            this.planeAnim.stop();\r\n        }, countDown * 1000);\r\n    }\r\n    spawnBullet(){\r\n        if(!this.spawnEnabled) return;\r\n            if(this.listItemB.length === 0){\r\n                let bulletPrefab0 = this.listBullet[0];\r\n                let prefabInstance0 = instantiate(bulletPrefab0);\r\n                prefabInstance0.parent = this.node.parent;\r\n                prefabInstance0.setWorldPosition(this.node.worldPosition.x, this.node.worldPosition.y+60, this.node.worldPosition.z);\r\n            }\r\n            if(this.listItemB.length === 1){\r\n                for(let j = 0; j < 3; j++){\r\n                    let bulletPrefab = this.listBullet[j];\r\n                    let prefabInstance = instantiate(bulletPrefab);\r\n                    prefabInstance.parent = this.node.parent;\r\n                    prefabInstance.setWorldPosition(this.node.worldPosition.x, this.node.worldPosition.y+60, this.node.worldPosition.z);\r\n                }\r\n            }\r\n            if(this.listItemB.length >= 2){\r\n                for(let j = 0; j < 5; j++){\r\n                    let bulletPrefab = this.listBullet[j];\r\n                    let prefabInstance = instantiate(bulletPrefab);\r\n                    prefabInstance.parent = this.node.parent;\r\n                    prefabInstance.setWorldPosition(this.node.worldPosition.x, this.node.worldPosition.y+60, this.node.worldPosition.z);\r\n                }\r\n            }\r\n    }\r\n    spawnRocket(){\r\n        if(this.listItemR.length >= 1){\r\n            let bulletPrefab5 = this.listBullet[5];\r\n            let prefabInstance5 = instantiate(bulletPrefab5);\r\n            prefabInstance5.parent = this.node.parent;\r\n            prefabInstance5.setWorldPosition(this.node.worldPosition.x+50, this.node.worldPosition.y, this.node.worldPosition.z);\r\n            let prefabInstance6 = instantiate(bulletPrefab5);\r\n            prefabInstance6.parent = this.node.parent;\r\n            prefabInstance6.setWorldPosition(this.node.worldPosition.x-50, this.node.worldPosition.y, this.node.worldPosition.z);\r\n        }\r\n    }\r\n    checkHealth(){\r\n        if(this.countCont.length === 1){\r\n            this.listHealth[4].active = false;\r\n        }\r\n        if(this.countCont.length === 2){\r\n            this.listHealth[3].active = false;\r\n        }\r\n        if(this.countCont.length === 3){\r\n            this.listHealth[2].active = false;\r\n        }\r\n        if(this.countCont.length === 4){\r\n            this.listHealth[1].active = false;\r\n        }\r\n        if(this.countCont.length === 5){\r\n            this.listHealth[0].active = false;\r\n            this.moveEnable = false;        \r\n            this.spawnEnabled = false;\r\n            GameCtrl.instance.overNode.active = true;\r\n            GameCtrl.instance.savePoint();\r\n        }\r\n    }\r\n}\r\n"]}