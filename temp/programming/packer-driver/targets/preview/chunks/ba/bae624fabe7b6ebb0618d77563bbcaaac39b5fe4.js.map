{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/Bullet.ts"],"names":["_decorator","Component","Vec3","Collider2D","Contact2DType","Prefab","instantiate","ccclass","property","Bullet","bulletSpeed","posX","posY","start","collider","getComponent","on","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","deltaTime","turn0","turn1","turn2","node","name","position","x","y","scheduleOnce","destroy","posBullet","setPosition","destroyB","destroyPrefab","destroyPre","prefabInstance","parent","setWorldPosition","worldPosition","selfCollider","otherCollider","contact","startsWith"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Vec3, Collider2D, Contact2DType, IPhysics2DContact, Prefab, instantiate } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Bullet')\r\nexport class Bullet extends Component {\r\n    public bulletSpeed: number = 10;\r\n    private posX: number;\r\n    private posY: number;\r\n\r\n    @property(Prefab)\r\n    public destroyPre: Prefab = null;\r\n\r\n    protected start(): void {\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n    update(deltaTime: number) {\r\n        this.turn0();\r\n        this.turn1();\r\n        this.turn2();\r\n    }\r\n    turn0(){\r\n        if(this.node.name == 'bullet0' || this.node.name == 'rocket'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 320){\r\n                this.scheduleOnce(() => {this.node?.destroy();})\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n    }\r\n    turn1(){\r\n        if(this.node.name == 'bullet1'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX -= this.bulletSpeed * 0.1;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 320){\r\n                this.scheduleOnce(() => {this.node?.destroy();})\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n        if(this.node.name == 'bullet2'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX += this.bulletSpeed * 0.1;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 320){\r\n                this.scheduleOnce(() => {this.node?.destroy();})\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n\r\n        }\r\n    }\r\n    turn2(){\r\n        if(this.node.name == 'bullet3'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX -= this.bulletSpeed * 0.2;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 320){\r\n                this.scheduleOnce(() => {this.node?.destroy();})\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n            if(this.node.name == 'bullet4'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n    \r\n            this.posX += this.bulletSpeed * 0.2;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 320){\r\n                this.scheduleOnce(() => {this.node?.destroy();})\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n    }\r\n    destroyB(){\r\n        let destroyPrefab = this.destroyPre;\r\n        let prefabInstance = instantiate(destroyPrefab);\r\n        prefabInstance.parent = this.node.parent;\r\n        prefabInstance.setWorldPosition(this.node.worldPosition);\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        if(otherCollider.name.startsWith('enemy') || otherCollider.name.startsWith('boss')){\r\n            this.destroyB();\r\n            this.scheduleOnce(() => {selfCollider.node?.destroy()});\r\n        }\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}