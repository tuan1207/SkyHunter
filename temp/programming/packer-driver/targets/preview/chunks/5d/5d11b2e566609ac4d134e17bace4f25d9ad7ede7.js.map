{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/BulletEN.ts"],"names":["_decorator","Component","ccclass","property","BulletEN","Prefab","bulletSpeed","posX","posY","start","collider","getComponent","Collider2D","on","Contact2DType","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","deltaTime","bulletE","selfCollider","otherCollider","contact","node","name","startsWith","destroyB","scheduleOnce","destroy","direction","Plane","instance","position","clone","subtract","normalize","distance","math","Vec3","x","y","setPosition","destroyPrefab","destroyPre","prefabInstance","instantiate","parent","setWorldPosition","worldPosition"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;;;;;;;;OACf;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;;0BAGjBI,Q,WADZF,OAAO,CAAC,UAAD,C,UAKHC,QAAQ,CAACE,MAAD,C,2BALb,MACaD,QADb,SAC8BH,SAD9B,CACwC;AAAA;AAAA;AAAA,eAC5BK,WAD4B,GACN,CADM;AAAA,eAE5BC,IAF4B;AAAA,eAG5BC,IAH4B;;AAAA;AAAA;;AAMpCC,QAAAA,KAAK,GAAG;AACJ,cAAIC,QAAQ,GAAG,KAAKC,YAAL,CAAkBC,UAAlB,CAAf;;AACA,cAAGF,QAAH,EAAY;AACRA,YAAAA,QAAQ,CAACG,EAAT,CAAYC,aAAa,CAACC,aAA1B,EAAyC,KAAKC,cAA9C,EAA8D,IAA9D;AACAN,YAAAA,QAAQ,CAACG,EAAT,CAAYC,aAAa,CAACG,WAA1B,EAAuC,KAAKC,YAA5C,EAA0D,IAA1D;AACH;AACJ;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,eAAKC,OAAL;AACH;;AACDL,QAAAA,cAAc,CAACM,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF;AAClG,cAAGD,aAAa,CAACE,IAAd,CAAmBC,IAAnB,CAAwBC,UAAxB,CAAmC,OAAnC,CAAH,EAA+C;AAC3C,iBAAKC,QAAL;AACA,iBAAKC,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAAP,YAAY,CAACG,IAAb,wCAAmBK,OAAnB;AAA6B,aAAtD;AACH;AACJ;;AACDZ,QAAAA,YAAY,CAACI,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF,CAEnG;;AACDH,QAAAA,OAAO,GAAE;AACL,cAAIU,SAAS,GAAGC,KAAK,CAACC,QAAN,CAAeD,KAAf,CAAqBE,QAArB,CAA8BC,KAA9B,GAAsCC,QAAtC,CAA+C,KAAKX,IAAL,CAAUS,QAAzD,EAAmEG,SAAnE,EAAhB;AACA,cAAIC,QAAQ,GAAGC,IAAI,CAACC,IAAL,CAAUF,QAAV,CAAmB,KAAKb,IAAL,CAAUS,QAA7B,EAAuCF,KAAK,CAACC,QAAN,CAAeD,KAAf,CAAqBE,QAA5D,CAAf;AACA,cAAI3B,IAAI,GAAG,KAAKkB,IAAL,CAAUS,QAAV,CAAmBO,CAAnB,GAAuBV,SAAS,CAACU,CAAV,GAAc,KAAKnC,WAArD;AACA,cAAIE,IAAI,GAAG,KAAKiB,IAAL,CAAUS,QAAV,CAAmBQ,CAAnB,GAAuBX,SAAS,CAACW,CAAV,GAAc,KAAKpC,WAArD;AACA,eAAKmB,IAAL,CAAUkB,WAAV,CAAsB,IAAIH,IAAJ,CAASjC,IAAT,EAAeC,IAAf,CAAtB;AACH;;AACDoB,QAAAA,QAAQ,GAAE;AACN,cAAIgB,aAAa,GAAG,KAAKC,UAAzB;AACA,cAAIC,cAAc,GAAGC,WAAW,CAACH,aAAD,CAAhC;AACAE,UAAAA,cAAc,CAACE,MAAf,GAAwB,KAAKvB,IAA7B;AACAqB,UAAAA,cAAc,CAACG,gBAAf,CAAgC,KAAKxB,IAAL,CAAUyB,aAA1C;AACH;;AAtCmC,O;;;;;iBAKR,I","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BulletEN')\r\nexport class BulletEN extends Component {\r\n    private bulletSpeed: number = 5;\r\n    private posX: number;\r\n    private posY: number;\r\n    @property(Prefab)\r\n    public destroyPre: Prefab = null;\r\n    start() {\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.bulletE();\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        if(otherCollider.node.name.startsWith('Plane')){\r\n            this.destroyB();\r\n            this.scheduleOnce(() => {selfCollider.node?.destroy()});\r\n        }\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n    }\r\n    bulletE(){\r\n        let direction = Plane.instance.Plane.position.clone().subtract(this.node.position).normalize();\r\n        let distance = math.Vec3.distance(this.node.position, Plane.instance.Plane.position);\r\n        let posX = this.node.position.x + direction.x * this.bulletSpeed;\r\n        let posY = this.node.position.y + direction.y * this.bulletSpeed;\r\n        this.node.setPosition(new Vec3(posX, posY));\r\n    }\r\n    destroyB(){\r\n        let destroyPrefab = this.destroyPre;\r\n        let prefabInstance = instantiate(destroyPrefab);\r\n        prefabInstance.parent = this.node;\r\n        prefabInstance.setWorldPosition(this.node.worldPosition);\r\n    }\r\n}\r\n\r\n\r\n"]}