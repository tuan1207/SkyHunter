{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/Bullet.ts"],"names":["_decorator","Component","Collider2D","Contact2DType","Prefab","instantiate","ccclass","property","Bullet","bulletSpeed","posX","posY","start","collider","getComponent","on","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","dt","node","destroy","console","log","destroyB","destroyPrefab","destroyPre","prefabInstance","parent","setWorldPosition","worldPosition","selfCollider","otherCollider","contact","name","startsWith","scheduleOnce"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAuBC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,a,OAAAA,a;AAAkCC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;;;;;;;;OAG5F;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;wBAGjBQ,M,WADZF,OAAO,CAAC,QAAD,C,UAMHC,QAAQ,CAACH,MAAD,C,2BANb,MACaI,MADb,SAC4BP,SAD5B,CACsC;AAAA;AAAA;AAAA,eAC3BQ,WAD2B,GACL,EADK;AAAA,eAE1BC,IAF0B;AAAA,eAG1BC,IAH0B;;AAAA;AAAA;;AAQxBC,QAAAA,KAAK,GAAS;AACpB,cAAIC,QAAQ,GAAG,KAAKC,YAAL,CAAkBZ,UAAlB,CAAf;;AACA,cAAGW,QAAH,EAAY;AACRA,YAAAA,QAAQ,CAACE,EAAT,CAAYZ,aAAa,CAACa,aAA1B,EAAyC,KAAKC,cAA9C,EAA8D,IAA9D;AACAJ,YAAAA,QAAQ,CAACE,EAAT,CAAYZ,aAAa,CAACe,WAA1B,EAAuC,KAAKC,YAA5C,EAA0D,IAA1D;AACH;AACJ;;AACDC,QAAAA,MAAM,CAACC,EAAD,EAAa;AACf,cAAG,KAAKV,IAAL,GAAY,GAAf,EAAmB;AACf,iBAAKW,IAAL,CAAUC,OAAV;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACH;AACJ;;AACDC,QAAAA,QAAQ,GAAE;AACN,cAAIC,aAAa,GAAG,KAAKC,UAAzB;AACA,cAAIC,cAAc,GAAGxB,WAAW,CAACsB,aAAD,CAAhC;AACAE,UAAAA,cAAc,CAACC,MAAf,GAAwB,KAAKR,IAAL,CAAUQ,MAAlC;AACAD,UAAAA,cAAc,CAACE,gBAAf,CAAgC,KAAKT,IAAL,CAAUU,aAA1C;AACH;;AACDf,QAAAA,cAAc,CAACgB,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF;AAClG,cAAGD,aAAa,CAACE,IAAd,CAAmBC,UAAnB,CAA8B,OAA9B,KAA0CH,aAAa,CAACE,IAAd,CAAmBC,UAAnB,CAA8B,MAA9B,CAA7C,EAAmF;AAC/E,iBAAKX,QAAL;AACA,iBAAKY,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAAL,YAAY,CAACX,IAAb,wCAAmBC,OAAnB;AAA6B,aAAtD;AACH;AACJ;;AACDJ,QAAAA,YAAY,CAACc,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF,CAEnG;;AAnCiC,O;;;;;iBAMN,I","sourcesContent":["import { _decorator, Component, Node, Vec3, Collider2D, Contact2DType, IPhysics2DContact, Prefab, instantiate } from 'cc';\r\nimport { Plane } from './Plane';\r\nimport { ButtonPlayScene } from './ButtonPlayScene';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Bullet')\r\nexport class Bullet extends Component {\r\n    public bulletSpeed: number = 10;\r\n    private posX: number;\r\n    private posY: number;\r\n\r\n    @property(Prefab)\r\n    public destroyPre: Prefab = null;\r\n\r\n    protected start(): void {\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n    update(dt: number) {\r\n        if(this.posY > 310){\r\n            this.node.destroy();\r\n            console.log('aaaa');\r\n        }\r\n    }\r\n    destroyB(){\r\n        let destroyPrefab = this.destroyPre;\r\n        let prefabInstance = instantiate(destroyPrefab);\r\n        prefabInstance.parent = this.node.parent;\r\n        prefabInstance.setWorldPosition(this.node.worldPosition);\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        if(otherCollider.name.startsWith('enemy') || otherCollider.name.startsWith('boss')){\r\n            this.destroyB();\r\n            this.scheduleOnce(() => {selfCollider.node?.destroy()});\r\n        }\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}