{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/Helicopter.ts"],"names":["_decorator","Component","Vec3","Collider2D","Contact2DType","Prefab","instantiate","GameCtrl","ButtonPlayScene","ccclass","property","Helicopter","bulletSpeed","posX","posY","spawnItemPos","contacted","start","collider","getComponent","on","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","deltaTime","instance","spawnEnabled","node","position","x","y","destroy","posBullet","setPosition","selfCollider","otherCollider","contact","name","scheduleOnce","spawnItem","randomIndex","Math","floor","random","items","length","randomPrefab","prefabInstance","addChild"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Vec3, Collider2D, Contact2DType, IPhysics2DContact, Prefab, instantiate } from 'cc';\r\nimport { GameCtrl } from './GameCtrl';\r\nimport { ButtonPlayScene } from './ButtonPlayScene';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Helicopter')\r\nexport class Helicopter extends Component {\r\n    public bulletSpeed: number = 10;\r\n    private posX: number;\r\n    private posY: number;\r\n    public spawnItemPos;\r\n    private contacted: boolean = false;\r\n    @property(Prefab)\r\n    public items: Prefab [] = []\r\n    start() {\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        if(!ButtonPlayScene.instance.spawnEnabled) return;\r\n\r\n        this.posX = this.node.position.x;\r\n        this.posY = this.node.position.y;\r\n\r\n        this.posX += this.bulletSpeed * 0.5;\r\n        if(this.posX > 690){\r\n            this.node.destroy();\r\n        }\r\n        let posBullet = new Vec3(this.posX, this.posY);\r\n        this.node.setPosition(posBullet);\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n        if(this.contacted) return;\r\n        if(otherCollider.node.name === 'bullet0' || otherCollider.node.name === 'rocket'){\r\n            this.scheduleOnce(() => {otherCollider.node?.destroy()}); \r\n            this.scheduleOnce(() => {this.spawnItem()}, 0.5);\r\n        }\r\n        this.contacted = true;\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        this.spawnItemPos = selfCollider.node.position;\r\n        this.scheduleOnce(() => {selfCollider.node.destroy()});\r\n\r\n    }\r\n\r\n    spawnItem(){\r\n        if(!ButtonPlayScene.instance.spawnEnabled) return;\r\n\r\n        let randomIndex = Math.floor(Math.random() * this.items.length);\r\n        let randomPrefab = this.items[randomIndex];\r\n\r\n        let prefabInstance = instantiate(randomPrefab);\r\n        prefabInstance.setPosition(this.spawnItemPos);\r\n        GameCtrl.instance.node.addChild(prefabInstance);\r\n    }\r\n}\r\n\r\n\r\n"]}