{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/Bullet.ts"],"names":["_decorator","Component","Vec3","Collider2D","Contact2DType","Prefab","instantiate","Plane","ButtonPlayScene","ccclass","property","Bullet","bulletSpeed","posX","posY","start","collider","getComponent","on","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","update","dt","turn0","turn1","turn2","instance","moveEnable","node","name","position","x","y","moveSpeed","scheduleOnce","destroy","posBullet","setPosition","destroyB","destroyPrefab","destroyPre","prefabInstance","parent","setWorldPosition","worldPosition","selfCollider","otherCollider","contact","startsWith"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,a,OAAAA,a;AAAkCC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;AACzFC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,e,iBAAAA,e;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;;wBAGjBW,M,WADZF,OAAO,CAAC,QAAD,C,UAMHC,QAAQ,CAACL,MAAD,C,2BANb,MACaM,MADb,SAC4BV,SAD5B,CACsC;AAAA;AAAA;AAAA,eAC3BW,WAD2B,GACL,EADK;AAAA,eAE1BC,IAF0B;AAAA,eAG1BC,IAH0B;;AAAA;AAAA;;AAQxBC,QAAAA,KAAK,GAAS;AACpB,cAAIC,QAAQ,GAAG,KAAKC,YAAL,CAAkBd,UAAlB,CAAf;;AACA,cAAGa,QAAH,EAAY;AACRA,YAAAA,QAAQ,CAACE,EAAT,CAAYd,aAAa,CAACe,aAA1B,EAAyC,KAAKC,cAA9C,EAA8D,IAA9D;AACAJ,YAAAA,QAAQ,CAACE,EAAT,CAAYd,aAAa,CAACiB,WAA1B,EAAuC,KAAKC,YAA5C,EAA0D,IAA1D;AACH;AACJ;;AACDC,QAAAA,MAAM,CAACC,EAAD,EAAa;AACf,eAAKC,KAAL;AACA,eAAKC,KAAL;AACA,eAAKC,KAAL;AACH;;AACDF,QAAAA,KAAK,GAAE;AACH,cAAG,CAAC;AAAA;AAAA,kDAAgBG,QAAhB,CAAyBC,UAA7B,EAAyC;;AACzC,cAAG,KAAKC,IAAL,CAAUC,IAAV,IAAkB,SAAlB,IAA+B,KAAKD,IAAL,CAAUC,IAAV,IAAkB,QAApD,EAA6D;AACzD,iBAAKlB,IAAL,GAAY,KAAKiB,IAAL,CAAUE,QAAV,CAAmBC,CAA/B;AACA,iBAAKnB,IAAL,GAAY,KAAKgB,IAAL,CAAUE,QAAV,CAAmBE,CAA/B;AAEA,iBAAKpB,IAAL,IAAa;AAAA;AAAA,gCAAMc,QAAN,CAAeO,SAAf,GAA2B,IAAxC;;AACA,gBAAG,KAAKrB,IAAL,IAAa,GAAhB,EAAoB;AAChB,mBAAKsB,YAAL,CAAkB,MAAM;AAAA;;AAAC,mCAAKN,IAAL,gCAAWO,OAAX;AAAqB,eAA9C;AACH;;AACD,gBAAIC,SAAS,GAAG,IAAIpC,IAAJ,CAAS,KAAKW,IAAd,EAAoB,KAAKC,IAAzB,CAAhB;AACA,iBAAKgB,IAAL,CAAUS,WAAV,CAAsBD,SAAtB;AACH;AACJ;;AACDZ,QAAAA,KAAK,GAAE;AACH,cAAG,CAAC;AAAA;AAAA,kDAAgBE,QAAhB,CAAyBC,UAA7B,EAAyC;;AACzC,cAAG,KAAKC,IAAL,CAAUC,IAAV,IAAkB,SAArB,EAA+B;AAC3B,iBAAKlB,IAAL,GAAY,KAAKiB,IAAL,CAAUE,QAAV,CAAmBC,CAA/B;AACA,iBAAKnB,IAAL,GAAY,KAAKgB,IAAL,CAAUE,QAAV,CAAmBE,CAA/B;AAEA,iBAAKrB,IAAL,IAAa,KAAKD,WAAL,GAAmB,GAAhC;AACA,iBAAKE,IAAL,IAAa,KAAKF,WAAlB;;AACA,gBAAG,KAAKE,IAAL,IAAa,GAAhB,EAAoB;AAChB,mBAAKsB,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAKN,IAAL,iCAAWO,OAAX;AAAqB,eAA9C;AACH;;AACD,gBAAIC,SAAS,GAAG,IAAIpC,IAAJ,CAAS,KAAKW,IAAd,EAAoB,KAAKC,IAAzB,CAAhB;AACA,iBAAKgB,IAAL,CAAUS,WAAV,CAAsBD,SAAtB;AACH;;AACD,cAAG,KAAKR,IAAL,CAAUC,IAAV,IAAkB,SAArB,EAA+B;AAC3B,iBAAKlB,IAAL,GAAY,KAAKiB,IAAL,CAAUE,QAAV,CAAmBC,CAA/B;AACA,iBAAKnB,IAAL,GAAY,KAAKgB,IAAL,CAAUE,QAAV,CAAmBE,CAA/B;AAEA,iBAAKrB,IAAL,IAAa,KAAKD,WAAL,GAAmB,GAAhC;AACA,iBAAKE,IAAL,IAAa,KAAKF,WAAlB;;AACA,gBAAG,KAAKE,IAAL,IAAa,GAAhB,EAAoB;AAChB,mBAAKsB,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAKN,IAAL,iCAAWO,OAAX;AAAqB,eAA9C;AACH;;AACD,gBAAIC,UAAS,GAAG,IAAIpC,IAAJ,CAAS,KAAKW,IAAd,EAAoB,KAAKC,IAAzB,CAAhB;;AACA,iBAAKgB,IAAL,CAAUS,WAAV,CAAsBD,UAAtB;AAEH;AACJ;;AACDX,QAAAA,KAAK,GAAE;AACH,cAAG,CAAC;AAAA;AAAA,kDAAgBC,QAAhB,CAAyBC,UAA7B,EAAyC;;AACzC,cAAG,KAAKC,IAAL,CAAUC,IAAV,IAAkB,SAArB,EAA+B;AAC3B,iBAAKlB,IAAL,GAAY,KAAKiB,IAAL,CAAUE,QAAV,CAAmBC,CAA/B;AACA,iBAAKnB,IAAL,GAAY,KAAKgB,IAAL,CAAUE,QAAV,CAAmBE,CAA/B;AAEA,iBAAKrB,IAAL,IAAa,KAAKD,WAAL,GAAmB,GAAhC;AACA,iBAAKE,IAAL,IAAa,KAAKF,WAAlB;;AACA,gBAAG,KAAKE,IAAL,IAAa,GAAhB,EAAoB;AAChB,mBAAKsB,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAKN,IAAL,iCAAWO,OAAX;AAAqB,eAA9C;AACH;;AACD,gBAAIC,SAAS,GAAG,IAAIpC,IAAJ,CAAS,KAAKW,IAAd,EAAoB,KAAKC,IAAzB,CAAhB;AACA,iBAAKgB,IAAL,CAAUS,WAAV,CAAsBD,SAAtB;AACH;;AACG,cAAG,KAAKR,IAAL,CAAUC,IAAV,IAAkB,SAArB,EAA+B;AAC/B,iBAAKlB,IAAL,GAAY,KAAKiB,IAAL,CAAUE,QAAV,CAAmBC,CAA/B;AACA,iBAAKnB,IAAL,GAAY,KAAKgB,IAAL,CAAUE,QAAV,CAAmBE,CAA/B;AAEA,iBAAKrB,IAAL,IAAa,KAAKD,WAAL,GAAmB,GAAhC;AACA,iBAAKE,IAAL,IAAa,KAAKF,WAAlB;;AACA,gBAAG,KAAKE,IAAL,IAAa,GAAhB,EAAoB;AAChB,mBAAKsB,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAKN,IAAL,iCAAWO,OAAX;AAAqB,eAA9C;AACH;;AACD,gBAAIC,WAAS,GAAG,IAAIpC,IAAJ,CAAS,KAAKW,IAAd,EAAoB,KAAKC,IAAzB,CAAhB;;AACA,iBAAKgB,IAAL,CAAUS,WAAV,CAAsBD,WAAtB;AACH;AACJ;;AACDE,QAAAA,QAAQ,GAAE;AACN,cAAIC,aAAa,GAAG,KAAKC,UAAzB;AACA,cAAIC,cAAc,GAAGrC,WAAW,CAACmC,aAAD,CAAhC;AACAE,UAAAA,cAAc,CAACC,MAAf,GAAwB,KAAKd,IAAL,CAAUc,MAAlC;AACAD,UAAAA,cAAc,CAACE,gBAAf,CAAgC,KAAKf,IAAL,CAAUgB,aAA1C;AACH;;AACD1B,QAAAA,cAAc,CAAC2B,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF;AAClG,cAAGD,aAAa,CAACjB,IAAd,CAAmBmB,UAAnB,CAA8B,OAA9B,KAA0CF,aAAa,CAACjB,IAAd,CAAmBmB,UAAnB,CAA8B,MAA9B,CAA7C,EAAmF;AAC/E,iBAAKV,QAAL;AACA,iBAAKJ,YAAL,CAAkB,MAAM;AAAA;;AAAC,oCAAAW,YAAY,CAACjB,IAAb,wCAAmBO,OAAnB;AAA6B,aAAtD;AACH;AACJ;;AACDf,QAAAA,YAAY,CAACyB,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAwF,CAEnG;;AAvGiC,O;;;;;iBAMN,I","sourcesContent":["import { _decorator, Component, Node, Vec3, Collider2D, Contact2DType, IPhysics2DContact, Prefab, instantiate } from 'cc';\r\nimport { Plane } from './Plane';\r\nimport { ButtonPlayScene } from './ButtonPlayScene';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Bullet')\r\nexport class Bullet extends Component {\r\n    public bulletSpeed: number = 10;\r\n    private posX: number;\r\n    private posY: number;\r\n\r\n    @property(Prefab)\r\n    public destroyPre: Prefab = null;\r\n\r\n    protected start(): void {\r\n        let collider = this.getComponent(Collider2D);\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n            collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n        }\r\n    }\r\n    update(dt: number) {\r\n        this.turn0();\r\n        this.turn1();\r\n        this.turn2();\r\n    }\r\n    turn0(){\r\n        if(!ButtonPlayScene.instance.moveEnable) return;\r\n        if(this.node.name == 'bullet0' || this.node.name == 'rocket'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posY += Plane.instance.moveSpeed * 0.05;\r\n            if(this.posY >= 300){\r\n                this.scheduleOnce(() => {this.node?.destroy()});\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n    }\r\n    turn1(){\r\n        if(!ButtonPlayScene.instance.moveEnable) return;\r\n        if(this.node.name == 'bullet1'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX -= this.bulletSpeed * 0.1;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 300){\r\n                this.scheduleOnce(() => {this.node?.destroy()});\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n        if(this.node.name == 'bullet2'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX += this.bulletSpeed * 0.1;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 300){\r\n                this.scheduleOnce(() => {this.node?.destroy()});\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n\r\n        }\r\n    }\r\n    turn2(){\r\n        if(!ButtonPlayScene.instance.moveEnable) return;\r\n        if(this.node.name == 'bullet3'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n\r\n            this.posX -= this.bulletSpeed * 0.2;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 300){\r\n                this.scheduleOnce(() => {this.node?.destroy()});\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n            if(this.node.name == 'bullet4'){\r\n            this.posX = this.node.position.x;\r\n            this.posY = this.node.position.y;\r\n    \r\n            this.posX += this.bulletSpeed * 0.2;\r\n            this.posY += this.bulletSpeed;\r\n            if(this.posY >= 300){\r\n                this.scheduleOnce(() => {this.node?.destroy()});\r\n            }\r\n            let posBullet = new Vec3(this.posX, this.posY);\r\n            this.node.setPosition(posBullet);\r\n        }\r\n    }\r\n    destroyB(){\r\n        let destroyPrefab = this.destroyPre;\r\n        let prefabInstance = instantiate(destroyPrefab);\r\n        prefabInstance.parent = this.node.parent;\r\n        prefabInstance.setWorldPosition(this.node.worldPosition);\r\n    }\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        if(otherCollider.name.startsWith('enemy') || otherCollider.name.startsWith('boss')){\r\n            this.destroyB();\r\n            this.scheduleOnce(() => {selfCollider.node?.destroy()});\r\n        }\r\n    }\r\n    onEndContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}