{"version":3,"sources":["file:///D:/Cocos%20Creator/Sky-Hunter/NewProject/assets/scripts/GameCtrl.ts"],"names":["_decorator","Component","Node","Prefab","Vec3","instantiate","Label","ProgressBar","sys","NodePool","ButtonPlayScene","ccclass","property","GameCtrl","destroyCount","highPoint","objectPool","spawnEnable","checkTurn1","listPos","onLoad","instance","spawnTurn1","i","enemyWave1","length","j","enemyPre","prefabInstance","parent","node","name","endsWith","setWorldPosition","x","y","z","spawnBoss1","listBoss","spawnObject","spawnEnabled","console","log","object","get","helicop","addChild","spawnHeli","helicopPre","spawnPos","setPosition","countPoint","point","countPointLb","string","overPointLb","savePoint","storedHighPoint","parseInt","localStorage","getItem","isNaN","setItem","toString","highPointLb"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Prefab, Vec3, instantiate, macro, Label, ProgressBar, System, sys, Pool, NodePool } from 'cc';\r\nimport { Plane } from './Plane';\r\nimport { ButtonPlayScene } from './ButtonPlayScene';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameCtrl')\r\nexport class GameCtrl extends Component {\r\n    static instance: GameCtrl;\r\n\r\n    @property(Prefab)\r\n    public enemyWave1: Prefab [] = [];\r\n    @property(Prefab)\r\n    public listBoss: Prefab [] = [];\r\n    @property(Prefab)\r\n    public helicop: Prefab = null;\r\n\r\n    @property(Node)\r\n    public overNode: Node = null;\r\n\r\n    @property(Label)\r\n    public countPointLb: Label;\r\n    @property(Label)\r\n    public overPointLb: Label;\r\n    @property(Label)\r\n    public highPointLb: Label;\r\n\r\n    @property(ProgressBar)\r\n    public healthBar: ProgressBar = null;\r\n\r\n    public destroyCount: number = 0;\r\n    public highPoint: number = 0;\r\n\r\n    private objectPool: NodePool;\r\n    \r\n    public spawnEnable: boolean = true;\r\n    public checkTurn1: boolean = true;\r\n    listPos = [\r\n        new Vec3(640, 760, -1), //turn 1, 3, 5, 7\r\n        new Vec3(-50, 760, -1), //turn 2\r\n        new Vec3(-100, 560, -1),//turn 4\r\n        new Vec3(-50, 270, -1), //turn 6\r\n        new Vec3(1330, 560, -1),//turn 8\r\n        new Vec3(1330, 270, -1),//turn 9\r\n        new Vec3(1330, 760, -1),//turn 10\r\n        new Vec3(640, 500, -1)  //turn boss\r\n    ];\r\n    protected onLoad(): void {\r\n        GameCtrl.instance = this;\r\n        // this.spawnTurn1();\r\n        // this.schedule(this.spawnObject, 5, macro.REPEAT_FOREVER, 0);\r\n        this.objectPool = new NodePool();\r\n    }\r\n    \r\n    spawnTurn1(){\r\n        if(!this.checkTurn1 || !this.spawnEnable) return;\r\n        // this.schedule(i++)\r\n        for(let i = 0; i < this.enemyWave1.length; i++){\r\n            for(let j = 0; j < 5; j++){\r\n                let enemyPre = this.enemyWave1[i];\r\n                let prefabInstance = instantiate(enemyPre);\r\n                prefabInstance.parent = this.node;  \r\n                if(enemyPre.name.endsWith('_0')){\r\n                    prefabInstance.setWorldPosition(this.listPos[0].x + (120 * (j - 2)), this.listPos[0].y, this.listPos[0].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_1')){\r\n                    prefabInstance.setWorldPosition(this.listPos[1].x - (100 * (0 + j)), this.listPos[1].y + (60 * (j + 1)), this.listPos[0].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_2')){\r\n                    prefabInstance.setWorldPosition(this.listPos[0].x, this.listPos[0].y + (120 * (0 + j)), this.listPos[0].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_3')){\r\n                    prefabInstance.setWorldPosition(this.listPos[2].x + (140 * (j - 2)), this.listPos[2].y, this.listPos[2].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_4')){\r\n                    prefabInstance.setWorldPosition(this.listPos[0].x, this.listPos[0].y + (120 * (0 + j)), this.listPos[0].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_5')){\r\n                    prefabInstance.setWorldPosition(this.listPos[3].x + (140 * (j - 2)), this.listPos[3].y, this.listPos[3].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_6')){\r\n                    prefabInstance.setWorldPosition(this.listPos[0].x + (120 * (j - 2)), this.listPos[0].y, this.listPos[0].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_7')){\r\n                    prefabInstance.setWorldPosition(this.listPos[4].x + (140 * (j - 2)), this.listPos[4].y, this.listPos[4].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_8')){\r\n                    prefabInstance.setWorldPosition(this.listPos[5].x + (140 * (j - 2)), this.listPos[5].y, this.listPos[5].z);\r\n                }\r\n                if(enemyPre.name.endsWith('_9')){\r\n                    prefabInstance.setWorldPosition(this.listPos[6].x + (100 * (0 + j)), this.listPos[6].y + (60 * (j + 1)), this.listPos[6].z);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    spawnBoss1(){\r\n        let enemyPre = this.listBoss[0];\r\n        let prefabInstance = instantiate(enemyPre);\r\n        prefabInstance.parent = this.node;\r\n        prefabInstance.setWorldPosition(this.listPos[7]);\r\n    }\r\n\r\n    spawnObject() {\r\n        if(!ButtonPlayScene.instance.spawnEnabled) return;\r\n        console.log('aaaaa');\r\n        let object = this.objectPool.get();\r\n        if (!object) {\r\n            object = instantiate(this.helicop);\r\n        }\r\n        object.parent = this.node;\r\n        object.setWorldPosition(0, 500, 0);\r\n        this.node.addChild(object);\r\n    }\r\n    spawnHeli(){\r\n        let helicopPre = this.helicop;\r\n        let prefabInstance = instantiate(helicopPre);\r\n        let spawnPos = new Vec3(-690, 225);\r\n        prefabInstance.setPosition(spawnPos);\r\n        this.node.addChild(prefabInstance);\r\n    }\r\n    countPoint(point: number){\r\n        this.destroyCount += point;\r\n        this.countPointLb.string = `${this.destroyCount}`;\r\n        this.overPointLb.string = `${this.destroyCount}`;\r\n    }\r\n    savePoint() {\r\n        this.overPointLb.string = `${this.destroyCount}`;\r\n\r\n        let storedHighPoint = parseInt(sys.localStorage.getItem('highPoint'));\r\n        if (!isNaN(storedHighPoint)) {\r\n            this.highPoint = storedHighPoint;\r\n        }\r\n\r\n        if (this.destroyCount > this.highPoint) {\r\n            this.highPoint = this.destroyCount;\r\n            sys.localStorage.setItem('highPoint', this.highPoint.toString());\r\n        }\r\n\r\n        this.highPointLb.string = `${this.highPoint}`;\r\n    }\r\n}\r\n\r\n\r\n"]}